
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Basic RNAseq Exploratory Data Analysis

Quick basic computer vocab beforehand:
**directory** means folder in computer lingo
**command line** the terminal app on mac, a basic guide can be found here: https://www.tjhsst.edu/~dhyatt/superap/unixcmd.html

## Loading a File

Most of data you will be dealing with will probably be RSEM outputs. These outputs are usually structured as a directory with a name like "Sub_0146_Developmental_Clock_Human_hg19__890bf46a388bf6b4". Inside will be a mess of files, the most likely ones you will be working with are genes.no_mt.**ec**.tab for counts data (NOT NORMALIZED) or TPMs genes.no_mt.**tpm**.renorm.tab. 


**QUICK NOTE:** If you have opened your files in Excel, always check the genes "MARCH1" and "SEPT1" to make sure that these gene names haven't been transformed into dates. If they have and you share/publish this data, people will instantly know you are a noob and discount any analysis you do!s


You can type "pwd ~" (pwd stands for print working directory) on the command line and it will tell you what your home directory is.

```{r one}
#load the package
library(biomaRt)
#This is your list of terms
termList <- c("GO:0030182")
mart <- useMart(biomart = "ENSEMBL_MART_ENSEMBL", dataset = "hsapiens_gene_ensembl", host="www.ensembl.org")

GeneData <- getBM(attributes=c('hgnc_symbol',"name_1006"),
                   filters = c('go'), values = termList, mart = mart)

print(head(GeneData))

``` 


We could also do this with a list of terms:

```{r many}
termList <- c("GO:0007399","GO:0097458","GO:0045202")
mart <- useMart(biomart = "ENSEMBL_MART_ENSEMBL", dataset = "hsapiens_gene_ensembl", host="www.ensembl.org")

GeneData <- getBM(attributes=c('hgnc_symbol'),
                   filters = c('go'), values = termList, mart = mart)

print(head(GeneData))

``` 
attributes is the list of things you want back from the database, in this case the gene symbol 'hgnc_symbol' . You can string multiple together by separating them with commas (You might want to include 'name_1006' for the names of all the terms associated with the genes as well)

filters is the data type that you're sending to the database, in this case the GO ID, 'go'.

values is the list of items you're querying

### Now save the list to a file on your desktop

This will write the data stored as "GeneData" to a file on your desktop

```{r saves}
write.table(GeneData,"~/Desktop/GO_Output.txt",sep = "\t",row.names = F,col.names = F, quote=F)
```

That's all you have to do to get a list of genes from a list of GO terms!

## Other Species

You can even change species by querying a different database (the mart object) and looking for the mouse symbols:
```{r mouse}
termList <- c("GO:0007399","GO:0097458","GO:0045202")
mart <- useMart(biomart = "ENSEMBL_MART_ENSEMBL", dataset = "mmusculus_gene_ensembl", host="www.ensembl.org")
GeneData <- getBM(attributes=c('mgi_symbol'),
                   filters = 'go', values = termList, mart = mart)

print(GeneData)
```


```{r biomart, eval=F}
source("http://bioconductor.org/biocLite.R")
#install package if not already installed
biocLite("biomaRt")
```


